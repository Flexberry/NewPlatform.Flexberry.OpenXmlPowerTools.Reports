using NewPlatform.Flexberry.Reports;
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using Xunit;

namespace NewPlatform.Flexberry.OpenXmlPowerTools.Reports.Tests
{
    public class DocxReportTests
    {
        private readonly string tmpFileContent = "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";

        /// <summary>
        /// Тест создания DocxReport и проверка блокироует ли он файл.
        /// </summary>
        [Fact]
        public void DocxReport_SaveAs_Then_FileOpen()
        {
            try
            {
                var fileName = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "tmp.docx");

                byte[] bytes = Convert.FromBase64String(tmpFileContent);
                File.WriteAllBytes(fileName, bytes);

                var fileNameToSave = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "tmp1.docx");

                var testDoc = new DocxReport(fileName);
                testDoc.SaveAs(fileNameToSave);

                MemoryStream memoryStream = new MemoryStream();

                using (FileStream fileStream = new FileStream(fileName, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite))
                {
                    fileStream.CopyTo(memoryStream);
                }

                File.Delete(fileNameToSave);
            }
            catch (Exception ex)
            {
                Assert.True(false, ex.Message);
            }
        }
    }
}
